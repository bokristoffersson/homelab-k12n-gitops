apiVersion: backstage.io/v1alpha1
kind: System
metadata:
  name: homelab
  description: Homelab Kubernetes infrastructure and applications
spec:
  owner: homelab-admins

---
apiVersion: backstage.io/v1alpha1
kind: Group
metadata:
  name: homelab-admins
  description: Homelab administrators
spec:
  type: team
  children: []

---
apiVersion: backstage.io/v1alpha1
kind: Component
metadata:
  name: heatpump-web
  description: Heat pump dashboard web application
  annotations:
    github.com/project-slug: bokristoffersson/homelab-k12n-gitops
    backstage.io/kubernetes-id: heatpump-web
    backstage.io/techdocs-ref: dir:./applications/heatpump-web
spec:
  type: website
  lifecycle: production
  owner: homelab-admins
  system: homelab

---
apiVersion: backstage.io/v1alpha1
kind: Component
metadata:
  name: homelab-api
  description: Homelab REST API
  annotations:
    github.com/project-slug: bokristoffersson/homelab-k12n-gitops
    backstage.io/kubernetes-id: homelab-api
spec:
  type: service
  lifecycle: production
  owner: homelab-admins
  system: homelab
  providesApis:
    - homelab-api

---
apiVersion: backstage.io/v1alpha1
kind: API
metadata:
  name: homelab-api
  description: Homelab REST API
  annotations:
    github.com/project-slug: bokristoffersson/homelab-k12n-gitops
spec:
  type: openapi
  lifecycle: production
  owner: homelab-admins
  system: homelab
  definition: |
    openapi: 3.0.0
    info:
      title: Homelab API
      version: 1.0.0
    paths:
      /api/v1/energy/latest:
        get:
          summary: Get latest energy data
      /api/v1/heatpump/latest:
        get:
          summary: Get latest heatpump status

---
apiVersion: backstage.io/v1alpha1
kind: Component
metadata:
  name: energy-ws
  description: WebSocket server for real-time energy data streaming
  annotations:
    github.com/project-slug: bokristoffersson/homelab-k12n-gitops
    backstage.io/kubernetes-id: energy-ws
spec:
  type: service
  lifecycle: production
  owner: homelab-admins
  system: homelab

---
apiVersion: backstage.io/v1alpha1
kind: Component
metadata:
  name: heatpump-settings
  description: Heat pump settings service
  annotations:
    github.com/project-slug: bokristoffersson/homelab-k12n-gitops
    backstage.io/kubernetes-id: heatpump-settings
spec:
  type: service
  lifecycle: production
  owner: homelab-admins
  system: homelab

---
apiVersion: backstage.io/v1alpha1
kind: Component
metadata:
  name: mqtt-kafka-bridge
  description: Bridge service between MQTT and Kafka for IoT data
  annotations:
    github.com/project-slug: bokristoffersson/homelab-k12n-gitops
    backstage.io/kubernetes-id: mqtt-kafka-bridge
spec:
  type: service
  lifecycle: production
  owner: homelab-admins
  system: homelab

---
apiVersion: backstage.io/v1alpha1
kind: Component
metadata:
  name: mosquitto
  description: MQTT broker for IoT device communication
  annotations:
    github.com/project-slug: bokristoffersson/homelab-k12n-gitops
    backstage.io/kubernetes-id: mosquitto
spec:
  type: service
  lifecycle: production
  owner: homelab-admins
  system: homelab

---
apiVersion: backstage.io/v1alpha1
kind: Component
metadata:
  name: grafana
  description: Metrics visualization and dashboards
  annotations:
    github.com/project-slug: bokristoffersson/homelab-k12n-gitops
    backstage.io/kubernetes-id: grafana
spec:
  type: website
  lifecycle: production
  owner: homelab-admins
  system: homelab

---
apiVersion: backstage.io/v1alpha1
kind: Resource
metadata:
  name: timescaledb
  description: TimescaleDB time-series database
  annotations:
    github.com/project-slug: bokristoffersson/homelab-k12n-gitops
    backstage.io/kubernetes-id: timescaledb
spec:
  type: database
  lifecycle: production
  owner: homelab-admins
  system: homelab

---
apiVersion: backstage.io/v1alpha1
kind: User
metadata:
  name: bo.kristoffersson
spec:
  profile:
    displayName: Bo Kristoffersson
    email: bo.kristoffersson@me.com
  memberOf: [homelab-admins]
