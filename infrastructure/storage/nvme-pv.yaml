# First, create the storage class for your NVMe storage
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: nvme-storage
provisioner: rancher.io/local-path # k3s local-path provisioner
parameters:
  nodePath: /mnt/nvme/local-path-storage # Directory where local-path will create subdirs
volumeBindingMode: WaitForFirstConsumer
reclaimPolicy: Retain
allowVolumeExpansion: true

---
# Node-specific storage configuration
apiVersion: v1
kind: ConfigMap
metadata:
  name: local-path-config
  namespace: kube-system
data:
  config.json: |-
    {
      "nodePathMap": [
        {
          "node": "worker-pi5",
          "paths": ["/mnt/nvme/local-path-storage"]
        }
      ]
    }
