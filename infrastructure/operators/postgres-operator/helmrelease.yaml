apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: postgres-operator
  namespace: postgres-operator
spec:
  interval: 30m
  chart:
    spec:
      chart: postgres-operator
      version: 1.12.x
      sourceRef:
        kind: HelmRepository
        name: postgres-operator
        namespace: postgres-operator
      interval: 12h
  values:
    # Configure the operator
    configGeneral:
      enable_crd_registration: true
      docker_image: ghcr.io/zalando/spilo-16:3.2-p3

    configKubernetes:
      storage_resize_mode: "pvc"
      enable_pod_antiaffinity: true

    # Resource limits for operator
    resources:
      limits:
        cpu: 500m
        memory: 500Mi
      requests:
        cpu: 100m
        memory: 250Mi