id: gh-run-watch
title: Watch GitHub Actions Workflow Run
intent: gh-run-watch
resource: workflow
risk_level: low

preconditions:
  - gh CLI must be authenticated
  - Workflow run ID or recent workflow must exist
  - User has read access to repository

command_template: "gh run watch {{run_id}} --repo {{repo}}"

flags:
  - name: --exit-status
    default: false
    note: Exit with non-zero status if run fails
  - name: --interval
    default: 3
    note: Refresh interval in seconds

defaults:
  exit_status: false
  interval: 3

examples:
  - goal: Watch latest workflow run
    render:
      command: gh run watch --repo bokristoffersson/homelab-k12n-gitops
      checks:
        - gh run list --repo bokristoffersson/homelab-k12n-gitops --limit 1

  - goal: Watch specific run ID
    render:
      command: gh run watch 21068039747 --repo bokristoffersson/homelab-k12n-gitops
      checks:
        - gh run view 21068039747 --repo bokristoffersson/homelab-k12n-gitops

  - goal: Watch run with exit status check
    render:
      command: gh run watch 21068039747 --repo bokristoffersson/homelab-k12n-gitops --exit-status
      checks:
        - gh run view 21068039747 --repo bokristoffersson/homelab-k12n-gitops

postprocess:
  summarize_to_json: false

notes:
  - Monitors workflow execution in real-time
  - Automatically refreshes status every few seconds
  - Use after pushing code to track CI/CD progress
  - --exit-status useful in scripts to detect failures
  - Press Ctrl+C to stop watching

references:
  - https://cli.github.com/manual/gh_run_watch
