id: view-configmap
title: View ConfigMap Contents
intent: config-view
resource: configmap
risk_level: none

preconditions:
  - ConfigMap must exist in the namespace
  - User has get permissions for configmaps

command_template: "kubectl get configmap {{name}} -n {{namespace}} -o yaml"

flags:
  - name: --output
    default: yaml
    note: Output format (yaml, json, or jsonpath)

defaults:
  output: yaml

examples:
  - goal: View postgres-migrations ConfigMap contents
    render:
      command: kubectl get configmap postgres-migrations -n heatpump-settings -o yaml
      checks:
        - Review data section for migration files
        - Verify file contents are correct
        - Check for any hash suffix in name

  - goal: View application configuration
    render:
      command: kubectl get configmap heatpump-settings-api-config -n heatpump-settings -o yaml
      checks:
        - Review configuration values
        - Verify environment-specific settings
        - Check for sensitive data (should use secrets instead)

  - goal: List all ConfigMaps in namespace
    render:
      command: kubectl get configmaps -n heatpump-settings
      checks:
        - Review all available ConfigMaps
        - Note any with hash suffixes (generated by Kustomize)
        - Check age to see recently updated configs

  - goal: Extract specific key from ConfigMap
    render:
      command: kubectl get configmap postgres-migrations -n heatpump-settings -o jsonpath='{.data.003_create_outbox_table\.sql}'
      checks:
        - Verify specific file content
        - Useful for debugging migration issues

postprocess:
  summarize_to_json: false

notes:
  - Shows full ConfigMap YAML including metadata and data
  - Kustomize generates hash suffixes for ConfigMaps (e.g., name-abc123)
  - Use kubectl get configmaps to find exact name with hash
  - Data section contains all key-value pairs
  - Useful for debugging configuration issues
  - After ConfigMap updates, pods need restart to reload config
  - Binary data appears as base64-encoded in binaryData section

references:
  - https://kubernetes.io/docs/concepts/configuration/configmap/
  - https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap/
